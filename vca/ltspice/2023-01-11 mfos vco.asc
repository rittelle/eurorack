Version 4
SHEET 1 4080 904
WIRE 1872 -1520 1872 -1552
WIRE 1872 -1408 1872 -1440
WIRE 2000 -1408 1872 -1408
WIRE 1872 -1376 1872 -1408
WIRE 1872 -1264 1872 -1296
WIRE 1472 -1216 1472 -1232
WIRE 2112 -1200 2112 -1232
WIRE 1472 -1184 1472 -1216
WIRE 2000 -1184 2000 -1408
WIRE 2080 -1184 2000 -1184
WIRE 80 -1168 80 -1216
WIRE 2240 -1168 2144 -1168
WIRE 2336 -1168 2240 -1168
WIRE 1872 -1152 1808 -1152
WIRE 2000 -1152 1952 -1152
WIRE 2080 -1152 2000 -1152
WIRE 2336 -1120 2336 -1168
WIRE 2112 -1104 2112 -1136
WIRE 1472 -1088 1472 -1104
WIRE 1568 -1088 1472 -1088
WIRE 960 -1072 960 -1104
WIRE 80 -1056 80 -1088
WIRE 656 -1056 80 -1056
WIRE 928 -1056 656 -1056
WIRE 1472 -1056 1472 -1088
WIRE 1072 -1040 992 -1040
WIRE 1232 -1040 1072 -1040
WIRE 1392 -1040 1312 -1040
WIRE 80 -1024 80 -1056
WIRE 928 -1024 880 -1024
WIRE 2336 -1008 2336 -1040
WIRE 2720 -1008 2336 -1008
WIRE 960 -976 960 -1008
WIRE 2000 -976 2000 -1152
WIRE 2080 -976 2000 -976
WIRE 2240 -976 2240 -1168
WIRE 2240 -976 2160 -976
WIRE 2336 -976 2336 -1008
WIRE 1472 -960 1472 -976
WIRE 1648 -960 1648 -992
WIRE 1568 -944 1568 -1088
WIRE 1616 -944 1568 -944
WIRE 1760 -928 1680 -928
WIRE 1808 -928 1808 -1152
WIRE 1808 -928 1760 -928
WIRE 2640 -928 2544 -928
WIRE 80 -912 80 -944
WIRE 880 -912 880 -1024
WIRE 1072 -912 1072 -1040
WIRE 1072 -912 880 -912
WIRE 1392 -912 1392 -1040
WIRE 1520 -912 1392 -912
WIRE 1536 -912 1520 -912
WIRE 1616 -912 1536 -912
WIRE 2544 -880 2544 -928
WIRE 2720 -880 2720 -1008
WIRE 1648 -864 1648 -896
WIRE 2336 -864 2336 -896
WIRE 2640 -864 2640 -928
WIRE 2672 -864 2640 -864
WIRE 960 -816 784 -816
WIRE 2672 -816 2640 -816
WIRE 1056 -768 1056 -800
WIRE 1520 -768 1520 -912
WIRE 1600 -768 1520 -768
WIRE 1760 -768 1760 -928
WIRE 1760 -768 1680 -768
WIRE 2544 -768 2544 -800
WIRE 2640 -768 2640 -816
WIRE 2640 -768 2544 -768
WIRE 960 -752 960 -816
WIRE 1024 -752 960 -752
WIRE 2544 -752 2544 -768
WIRE 1152 -736 1088 -736
WIRE 1184 -736 1152 -736
WIRE 1232 -736 1184 -736
WIRE 1392 -736 1312 -736
WIRE 288 -720 80 -720
WIRE 848 -720 288 -720
WIRE 960 -720 928 -720
WIRE 1024 -720 960 -720
WIRE 2080 -688 2080 -736
WIRE 80 -672 80 -720
WIRE 288 -672 288 -720
WIRE 656 -672 288 -672
WIRE 1056 -672 1056 -704
WIRE 2720 -672 2720 -800
WIRE 3264 -672 2720 -672
WIRE 288 -640 288 -672
WIRE 656 -640 656 -672
WIRE 1808 -640 1808 -928
WIRE 2016 -640 1808 -640
WIRE 2320 -640 2240 -640
WIRE 2320 -608 2320 -640
WIRE 2640 -608 2544 -608
WIRE 2544 -576 2544 -608
WIRE 2720 -576 2720 -672
WIRE 2240 -560 2240 -640
WIRE 2640 -560 2640 -608
WIRE 2672 -560 2640 -560
WIRE 80 -544 80 -592
WIRE 960 -544 960 -720
WIRE 1024 -544 960 -544
WIRE 1152 -544 1152 -736
WIRE 1152 -544 1104 -544
WIRE 288 -528 288 -560
WIRE 656 -528 656 -560
WIRE 656 -528 288 -528
WIRE 784 -528 784 -816
WIRE 784 -528 656 -528
WIRE 2080 -512 2080 -592
WIRE 2176 -512 2080 -512
WIRE 2672 -512 2640 -512
WIRE 288 -496 288 -528
WIRE 656 -496 656 -528
WIRE 2080 -480 2080 -512
WIRE 2544 -464 2544 -496
WIRE 2640 -464 2640 -512
WIRE 2640 -464 2544 -464
WIRE 2544 -448 2544 -464
WIRE 2240 -400 2240 -464
WIRE 288 -384 288 -416
WIRE 656 -384 656 -416
WIRE 656 -384 288 -384
WIRE 288 -336 288 -384
WIRE 2080 -336 2080 -400
WIRE 2240 -272 2240 -320
WIRE 2720 -272 2720 -496
WIRE 2720 -272 2240 -272
WIRE 1568 -96 1568 -128
WIRE 1568 16 1568 -16
WIRE 1568 16 1536 16
WIRE 1536 32 1536 16
WIRE 2560 48 2320 48
WIRE 2784 48 2560 48
WIRE 2928 48 2864 48
WIRE 1568 64 1568 16
WIRE 2928 96 2928 48
WIRE 3040 96 2928 96
WIRE 3088 96 3040 96
WIRE 3216 112 3216 80
WIRE 3264 112 3264 -672
WIRE 2560 128 2560 48
WIRE 2928 144 2928 96
WIRE 3088 144 3088 96
WIRE 3152 144 3088 144
WIRE 1568 176 1568 144
WIRE 3152 208 3088 208
WIRE 2320 256 2320 208
WIRE 2560 256 2560 208
WIRE 2928 272 2928 224
WIRE 3216 272 3216 240
WIRE 3408 272 3408 240
WIRE 3760 272 3408 272
WIRE 3840 272 3760 272
WIRE 3984 272 3920 272
WIRE 3296 304 3296 240
WIRE 3328 304 3328 240
WIRE 3328 304 3296 304
WIRE 3552 304 3328 304
WIRE 3760 320 3760 272
WIRE 2928 384 2928 352
WIRE 3088 384 3088 208
WIRE 3088 384 2928 384
WIRE 2928 416 2928 384
WIRE 3760 432 3760 400
WIRE 3184 496 3184 464
WIRE 3456 496 3456 464
WIRE 3184 608 3184 576
WIRE 3296 608 3184 608
WIRE 3456 608 3456 576
WIRE 3456 608 3376 608
WIRE 3552 608 3552 304
WIRE 3552 608 3456 608
WIRE 3184 640 3184 608
WIRE 3456 640 3456 608
WIRE 3184 752 3184 720
WIRE 3456 752 3456 720
FLAG 1568 -128 V+
FLAG 1568 176 V-
FLAG 1536 32 0
FLAG 2560 256 0
FLAG 80 -544 0
FLAG 1056 -800 V+
FLAG 1056 -672 V-
FLAG 288 -336 0
FLAG 1648 -992 V+
FLAG 1648 -864 V-
FLAG 80 -1216 V+
FLAG 80 -912 V-
FLAG 1472 -960 0
FLAG 1472 -1216 V+
FLAG 2112 -1232 V+
FLAG 2112 -1104 V-
FLAG 1872 -1264 0
FLAG 1872 -1552 V+
FLAG 2336 -864 V-
FLAG 2080 -336 V-
FLAG 2080 -736 V+
FLAG 2320 -608 0
FLAG 2544 -752 0
FLAG 2544 -448 0
FLAG 2928 416 0
FLAG 3216 80 V+
FLAG 3216 272 V-
FLAG 3456 464 V+
FLAG 3184 752 V-
FLAG 3456 752 0
FLAG 3184 464 V+
FLAG 3760 432 V-
FLAG 3984 272 out
IOPIN 3984 272 Out
FLAG 1760 -928 in_sum
FLAG 1536 -912 in_sum_raw
FLAG 1184 -736 att_out
FLAG 80 -720 cv
FLAG 656 -1056 offset
FLAG 2560 48 in
FLAG 2320 256 0
FLAG 3040 96 trim
FLAG 960 -1104 V+
FLAG 960 -976 V-
SYMBOL voltage 1568 -112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 44 Left 2
SYMATTR InstName V1
SYMATTR Value 12
SYMBOL voltage 1568 48 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 12
SYMBOL voltage 2560 112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value SINE(0 {amplitude} 1k)
SYMBOL voltage 80 -688 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value {cv}
SYMBOL AutoGenerated\\TL072 1056 -736 R0
SYMATTR InstName U1
SYMBOL res 272 -512 R0
SYMATTR InstName R1
SYMATTR Value {100k*attenuverter}
SYMBOL res 272 -656 R0
SYMATTR InstName R2
SYMATTR Value {100k*(1-attenuverter)}
SYMBOL res 944 -736 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 100k
SYMBOL res 640 -512 R0
SYMATTR InstName R4
SYMATTR Value 10Meg
SYMBOL res 640 -656 R0
SYMATTR InstName R5
SYMATTR Value 10Meg
SYMBOL res 1120 -560 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL AutoGenerated\\TL072 1648 -928 R0
SYMATTR InstName U2
SYMBOL res 64 -1040 R0
SYMATTR InstName R7
SYMATTR Value {100k*offset}
SYMBOL res 64 -1184 R0
SYMATTR InstName R8
SYMATTR Value {100k*(1-offset)}
SYMBOL res 1328 -1056 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 100k
SYMBOL res 1328 -752 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 100k
SYMBOL res 1456 -1200 R0
SYMATTR InstName R11
SYMATTR Value 100k
SYMBOL res 1456 -1072 R0
SYMATTR InstName R12
SYMATTR Value 2k
SYMBOL AutoGenerated\\TL072 2112 -1168 R0
SYMATTR InstName U3
SYMBOL res 1856 -1536 R0
SYMATTR InstName R13
SYMATTR Value 100k
SYMBOL res 1856 -1392 R0
SYMATTR InstName R14
SYMATTR Value 470
SYMBOL res 1968 -1168 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 2k
SYMBOL res 2176 -992 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 100k
SYMBOL res 2320 -1136 R0
SYMATTR InstName R17
SYMATTR Value 30k
SYMBOL res 2320 -992 R0
SYMATTR InstName R18
SYMATTR Value 20k
SYMBOL npn 2016 -688 R0
SYMATTR InstName Q1
SYMATTR Value 2N3904
SYMBOL pnp 2176 -464 M180
SYMATTR InstName Q2
SYMATTR Value 2N3906
SYMBOL res 2064 -496 R0
SYMATTR InstName R19
SYMATTR Value 120k
SYMBOL res 2224 -416 R0
SYMATTR InstName R20
SYMATTR Value 20k
SYMBOL sw 2720 -784 M180
SYMATTR InstName S1
SYMATTR Value MySwitch
SYMBOL sw 2720 -480 M180
SYMATTR InstName S2
SYMATTR Value MySwitch
SYMBOL voltage 2544 -592 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value {-SwitchState}
SYMBOL voltage 2544 -896 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value {SwitchState}
SYMBOL AutoGenerated\\LM13700_NS 3296 176 R0
SYMATTR InstName U4
SYMBOL res 2880 32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value 100k
SYMBOL res 2912 128 R0
SYMATTR InstName R22
SYMATTR Value {2k * trim}
SYMBOL res 2912 256 R0
SYMATTR InstName R23
SYMATTR Value 150
SYMBOL res 3168 480 R0
SYMATTR InstName R24
SYMATTR Value {100k * bias}
SYMBOL res 3168 624 R0
SYMATTR InstName R25
SYMATTR Value {100k * (1 - bias)}
SYMBOL res 3440 480 R0
SYMATTR InstName R26
SYMATTR Value 470k
SYMBOL res 3440 624 R0
SYMATTR InstName R27
SYMATTR Value 47k
SYMBOL res 3392 592 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R28
SYMATTR Value 2Meg
SYMBOL res 3744 304 R0
SYMATTR InstName R29
SYMATTR Value 4.7k
SYMBOL res 3936 256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R30
SYMATTR Value 1k
SYMBOL res 1696 -784 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R31
SYMATTR Value 2k
SYMBOL voltage 2320 112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value {amplitude}
SYMBOL AutoGenerated\\TL072 960 -1040 R0
SYMATTR InstName U5
TEXT 2352 -248 Left 2 !.model MySwitch SW(Vt=0 Vh=-.5)
TEXT 2432 -664 Left 2 !.param SwitchState=-1
TEXT 2888 472 Left 2 !.param trim=0.45
TEXT 3096 808 Left 2 !.param bias=0.9
TEXT -8 -840 Left 2 !.param offset=0.70
TEXT 272 -272 Left 2 !.param attenuverter=0.75
TEXT 1406 -508 Left 2 !.tran 1m
TEXT 16 -480 Left 2 !.param cv=0
TEXT 272 -240 Left 2 ;.step param attenuverter 0.1 0.9 0.2
TEXT -8 -816 Left 2 ;.step param offset 0.01 0.99 0.02
TEXT 1406 -476 Left 2 ;.dc V4 0 5 0.1
TEXT 2800 504 Left 2 ;Trim, so that V(trim) as an \namplitude of 50mV at +-5V \ninput amplitude
TEXT 2496 320 Left 2 !.param amplitude=5
TEXT 3048 840 Left 2 ;Trim, so that V(out) is 0V when \nthe amplitude of V(in) is 0V
