Version 4
SHEET 1 2176 3096
WIRE 1200 -192 1072 -192
WIRE 144 -176 80 -176
WIRE 1200 -160 1200 -192
WIRE 80 -128 80 -176
WIRE 1200 -48 1200 -80
WIRE 1024 -16 1024 -48
WIRE 1072 -16 1072 -192
WIRE 80 0 80 -48
WIRE 864 16 752 16
WIRE 960 16 944 16
WIRE 640 48 640 16
WIRE 608 64 576 64
WIRE 752 80 672 80
WIRE 800 80 752 80
WIRE 960 80 880 80
WIRE 464 96 416 96
WIRE 576 96 544 96
WIRE 608 96 576 96
WIRE 640 144 640 112
WIRE 1024 144 1024 112
WIRE 80 160 80 128
WIRE 1296 160 1296 128
WIRE 1104 176 1104 112
WIRE 1184 176 1104 176
WIRE 1264 176 1184 176
WIRE 1104 192 1104 176
WIRE 1424 192 1328 192
WIRE 1632 192 1424 192
WIRE 1648 192 1632 192
WIRE 1264 208 1232 208
WIRE 576 240 576 96
WIRE 608 240 576 240
WIRE 752 240 752 80
WIRE 752 240 688 240
WIRE 1424 240 1424 192
WIRE 1632 240 1632 192
WIRE 1296 256 1296 224
WIRE 80 272 80 240
WIRE 80 272 32 272
WIRE 32 288 32 272
WIRE 80 304 80 272
WIRE 1104 304 1104 272
WIRE 1232 336 1232 208
WIRE 1424 336 1424 320
WIRE 1424 336 1232 336
WIRE 1424 352 1424 336
WIRE 1632 352 1632 320
WIRE 80 416 80 384
WIRE 1424 464 1424 432
WIRE 1136 496 1008 496
WIRE 1136 528 1136 496
WIRE 688 560 624 560
WIRE 784 560 768 560
WIRE 864 560 784 560
WIRE 784 576 784 560
WIRE 1136 640 1136 608
WIRE 960 672 960 640
WIRE 1008 672 1008 496
WIRE 784 688 784 656
WIRE 864 704 864 560
WIRE 896 704 864 704
WIRE 576 736 576 704
WIRE 544 752 512 752
WIRE 688 768 608 768
WIRE 736 768 688 768
WIRE 896 768 816 768
WIRE 1440 768 1392 768
WIRE 1584 768 1520 768
WIRE 400 784 352 784
WIRE 512 784 480 784
WIRE 544 784 512 784
WIRE 576 832 576 800
WIRE 960 832 960 800
WIRE 1232 848 1232 816
WIRE 1040 864 1040 800
WIRE 1120 864 1040 864
WIRE 1200 864 1120 864
WIRE 1040 880 1040 864
WIRE 1360 880 1264 880
WIRE 1392 880 1392 768
WIRE 1392 880 1360 880
WIRE 1568 880 1392 880
WIRE 1584 880 1568 880
WIRE 1200 896 1168 896
WIRE 512 928 512 784
WIRE 544 928 512 928
WIRE 688 928 688 768
WIRE 688 928 624 928
WIRE 1360 928 1360 880
WIRE 1568 928 1568 880
WIRE 1232 944 1232 912
WIRE 1040 992 1040 960
WIRE 1168 1024 1168 896
WIRE 1360 1024 1360 1008
WIRE 1360 1024 1168 1024
WIRE 1360 1040 1360 1024
WIRE 1568 1040 1568 1008
WIRE 1360 1152 1360 1120
WIRE 1968 1168 1968 1136
WIRE 1072 1328 944 1328
WIRE 1072 1360 1072 1328
WIRE 1072 1472 1072 1440
WIRE 512 1504 512 1472
WIRE 896 1504 896 1472
WIRE 944 1504 944 1328
WIRE 480 1520 448 1520
WIRE 624 1536 544 1536
WIRE 672 1536 624 1536
WIRE 832 1536 752 1536
WIRE 336 1552 288 1552
WIRE 448 1552 416 1552
WIRE 480 1552 448 1552
WIRE 1536 1552 1488 1552
WIRE 1680 1552 1616 1552
WIRE 512 1600 512 1568
WIRE 720 1600 656 1600
WIRE 832 1600 800 1600
WIRE 1248 1648 1248 1616
WIRE 896 1664 896 1632
WIRE 1008 1664 1008 1632
WIRE 1216 1664 1184 1664
WIRE 1360 1680 1280 1680
WIRE 1392 1680 1360 1680
WIRE 1488 1680 1488 1552
WIRE 1488 1680 1472 1680
WIRE 1504 1680 1488 1680
WIRE 448 1696 448 1552
WIRE 480 1696 448 1696
WIRE 624 1696 624 1536
WIRE 624 1696 560 1696
WIRE 976 1696 976 1632
WIRE 1056 1696 976 1696
WIRE 1152 1696 1056 1696
WIRE 1216 1696 1152 1696
WIRE 1488 1728 1488 1680
WIRE 1248 1744 1248 1712
WIRE 1152 1840 1152 1696
WIRE 1216 1840 1152 1840
WIRE 1360 1840 1360 1680
WIRE 1360 1840 1296 1840
WIRE 1488 1840 1488 1808
WIRE 784 2176 784 2144
WIRE 1056 2176 928 2176
WIRE 1056 2208 1056 2176
WIRE 1056 2320 1056 2288
WIRE 496 2352 496 2320
WIRE 880 2352 880 2320
WIRE 928 2352 928 2176
WIRE 464 2368 432 2368
WIRE 608 2384 528 2384
WIRE 656 2384 608 2384
WIRE 816 2384 736 2384
WIRE 320 2400 272 2400
WIRE 432 2400 400 2400
WIRE 464 2400 432 2400
WIRE 1520 2400 1472 2400
WIRE 1664 2400 1600 2400
WIRE 816 2416 784 2416
WIRE 496 2448 496 2416
WIRE 704 2448 640 2448
WIRE 816 2448 784 2448
WIRE 1232 2496 1232 2464
WIRE 880 2512 880 2480
WIRE 992 2512 992 2480
WIRE 1200 2512 1168 2512
WIRE 1344 2528 1264 2528
WIRE 1376 2528 1344 2528
WIRE 1472 2528 1456 2528
WIRE 1488 2528 1472 2528
WIRE 432 2544 432 2400
WIRE 464 2544 432 2544
WIRE 608 2544 608 2384
WIRE 608 2544 544 2544
WIRE 960 2544 960 2480
WIRE 1040 2544 960 2544
WIRE 1136 2544 1040 2544
WIRE 1200 2544 1136 2544
WIRE 960 2560 960 2544
WIRE 1472 2576 1472 2528
WIRE 1232 2592 1232 2560
WIRE 960 2672 960 2640
WIRE 1136 2688 1136 2544
WIRE 1200 2688 1136 2688
WIRE 1344 2688 1344 2528
WIRE 1344 2688 1280 2688
WIRE 1472 2688 1472 2656
WIRE 608 3024 608 2960
FLAG 32 288 0
FLAG 80 416 V-
FLAG 80 128 V+
FLAG 1024 -48 V+
FLAG 1024 144 V-
FLAG 1104 304 0
FLAG 1296 128 V+
FLAG 1296 256 V-
FLAG 1632 352 0
FLAG 1648 192 out1
IOPIN 1648 192 Out
FLAG 1184 176 out1_raw
FLAG 80 0 0
FLAG 144 -176 in
IOPIN 144 -176 Out
FLAG 1200 -48 V-
FLAG 640 16 V+
FLAG 640 144 V-
FLAG 576 64 0
FLAG 752 16 0
FLAG 416 96 in
IOPIN 416 96 In
FLAG 752 80 in_att
FLAG 1968 1168 0
FLAG 1424 464 0
FLAG 960 640 V+
FLAG 960 832 V-
FLAG 1040 992 0
FLAG 1232 816 V+
FLAG 1232 944 V-
FLAG 1568 1040 0
FLAG 1584 880 out2
IOPIN 1584 880 Out
FLAG 1120 864 out2_raw
FLAG 1136 640 V-
FLAG 576 704 V+
FLAG 576 832 V-
FLAG 512 752 0
FLAG 624 560 0
FLAG 352 784 in
IOPIN 352 784 In
FLAG 688 768 in2_att
FLAG 1360 1152 0
FLAG 784 688 V-
FLAG 1584 768 out2_without_offset
IOPIN 1584 768 Out
FLAG 896 1472 V+
FLAG 896 1664 V-
FLAG 1248 1616 V+
FLAG 1248 1744 V-
FLAG 1488 1840 0
FLAG 1504 1680 out3
IOPIN 1504 1680 Out
FLAG 1056 1696 out3_raw
FLAG 1072 1472 V-
FLAG 512 1472 V+
FLAG 512 1600 V-
FLAG 448 1520 0
FLAG 656 1600 0
FLAG 288 1552 in
IOPIN 288 1552 In
FLAG 624 1536 in3_att
FLAG 1680 1552 out3_without_offset
IOPIN 1680 1552 Out
FLAG 1184 1664 0
FLAG 1008 1664 0
FLAG 880 2320 V+
FLAG 880 2512 V-
FLAG 1232 2464 V+
FLAG 1232 2592 V-
FLAG 1472 2688 0
FLAG 1488 2528 out4
IOPIN 1488 2528 Out
FLAG 1040 2544 out4_raw
FLAG 1056 2320 V-
FLAG 496 2320 V+
FLAG 496 2448 V-
FLAG 432 2368 0
FLAG 640 2448 0
FLAG 272 2400 in
IOPIN 272 2400 In
FLAG 608 2384 in4_att
FLAG 1664 2400 out4_without_offset
IOPIN 1664 2400 Out
FLAG 1168 2512 0
FLAG 992 2512 0
FLAG 1472 2400 0
FLAG 784 2144 V+
FLAG 608 3024 V-
FLAG 960 2672 0
SYMBOL voltage 80 144 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 12
SYMBOL voltage 80 288 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 12
SYMBOL AutoGenerated\\LM13700_NS 1104 48 R0
SYMATTR InstName U1
SYMBOL res 1088 176 R0
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL AutoGenerated\\TL072 1296 192 R0
SYMATTR InstName U3
SYMBOL res 1616 224 R0
SYMATTR InstName R4
SYMATTR Value 33k
SYMBOL res 1408 336 R0
SYMATTR InstName R6
SYMATTR Value {(1 - lin) * 10k + 1k}
SYMBOL res 1408 224 R0
SYMATTR InstName R5
SYMATTR Value 50k
SYMBOL voltage 80 -144 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 0
SYMBOL current 1200 -80 R180
WINDOW 0 24 80 Left 2
WINDOW 3 24 0 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I2
SYMATTR Value {Iabc}
SYMBOL AutoGenerated\\TL072 640 80 R0
SYMATTR InstName U4
SYMBOL res 560 80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 1Meg
SYMBOL res 704 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value {(1 - lin) * 10k + 10}
SYMBOL res 896 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 1k
SYMBOL res 960 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 1k
SYMBOL AutoGenerated\\LM13700_NS 1040 736 R0
SYMATTR InstName U2
SYMBOL res 1024 864 R0
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL AutoGenerated\\TL072 1232 880 R0
SYMATTR InstName U5
SYMBOL res 1552 912 R0
SYMATTR InstName R3
SYMATTR Value 33k
SYMBOL res 1344 1024 R0
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL res 1344 912 R0
SYMATTR InstName R10
SYMATTR Value 50k
SYMBOL current 1136 608 R180
WINDOW 0 24 80 Left 2
WINDOW 3 24 0 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I1
SYMATTR Value {Iabc}
SYMBOL AutoGenerated\\TL072 576 768 R0
SYMATTR InstName U6
SYMBOL res 496 768 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 1Meg
SYMBOL res 640 912 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 10k
SYMBOL res 832 752 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 1k
SYMBOL res 784 544 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 1k
SYMBOL res 768 560 R0
SYMATTR InstName R17
SYMATTR Value 30Meg
SYMBOL voltage 1424 768 R270
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 34.943m
SYMBOL AutoGenerated\\LM13700_NS 976 1568 R0
SYMATTR InstName U7
SYMBOL AutoGenerated\\TL072 1248 1680 R0
SYMATTR InstName U8
SYMBOL res 1472 1712 R0
SYMATTR InstName R19
SYMATTR Value 100k
SYMBOL current 1072 1440 R180
WINDOW 0 24 80 Left 2
WINDOW 3 24 0 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I3
SYMATTR Value 100µ
SYMBOL AutoGenerated\\TL072 512 1536 R0
SYMATTR InstName U9
SYMBOL res 432 1536 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R22
SYMATTR Value 1Meg
SYMBOL res 576 1680 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 5k
SYMBOL res 768 1520 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R24
SYMATTR Value 1k
SYMBOL res 816 1584 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R25
SYMATTR Value 1k
SYMBOL voltage 1520 1552 R270
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value -129.736m
SYMBOL res 1312 1824 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value 100k
SYMBOL res 1488 1664 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 1k
SYMBOL AutoGenerated\\LM13700_NS 960 2416 R0
SYMATTR InstName U10
SYMBOL AutoGenerated\\TL072 1232 2528 R0
SYMATTR InstName U11
SYMBOL res 1456 2560 R0
SYMATTR InstName R21
SYMATTR Value 100k
SYMBOL current 1056 2288 R180
WINDOW 0 24 80 Left 2
WINDOW 3 24 0 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I4
SYMATTR Value 100µ
SYMBOL AutoGenerated\\TL072 496 2384 R0
SYMATTR InstName U12
SYMBOL res 416 2384 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R26
SYMATTR Value 1Meg
SYMBOL res 560 2528 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R27
SYMATTR Value 5k
SYMBOL res 752 2368 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R28
SYMATTR Value 1k
SYMBOL res 800 2432 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R29
SYMATTR Value 1k
SYMBOL voltage 1504 2400 R270
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value -129.736m
SYMBOL res 1296 2672 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R30
SYMATTR Value 100k
SYMBOL res 1472 2512 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R31
SYMATTR Value 1k
SYMBOL res 768 2160 R0
SYMATTR InstName R32
SYMATTR Value 12k
SYMBOL res 592 2864 R0
SYMATTR InstName R33
SYMATTR Value 80k
SYMBOL res 944 2544 R0
SYMATTR InstName R34
SYMATTR Value 10k
TEXT 0 544 Left 2 !.param Iabc=100u
TEXT -96 520 Left 2 ;transconductance at Iabc=100uA: ~20mS
TEXT 14 736 Left 2 !.dc V3 -5 5 0.01
TEXT 24 648 Left 2 ;.step param lin 0 1 0.2
TEXT -32 624 Left 2 ;Amount of linearization 0..1
TEXT 976 336 Left 2 ;lm13700 gain: 20 (Iabc=100uA)
TEXT 912 1024 Left 2 ;gain: ~-20 (Iabc=100uA)
TEXT 752 832 Left 2 ;target: 50mVpp
TEXT 512 1000 Left 2 ;gain: -1/100
TEXT 488 608 Left 2 ;offset calibration\n(experimentally chosen)
TEXT 1224 1048 Left 2 ;gain: 5
TEXT 1408 808 Left 2 ;manual offset elimination\nfor gain plots
TEXT 856 1920 Left 2 ;transconductance\n~2mS (Iabc=100uA)
TEXT 688 1664 Left 2 ;target: 25mVpp
TEXT 448 1768 Left 2 ;gain: -1/200
TEXT 1504 1592 Left 2 ;manual offset elimination\nfor gain plots
TEXT 1152 1920 Left 2 ;transresistance\n-(1/2mS * (-200)) = -100kOhm
TEXT 464 1800 Left 2 ;adjustable
TEXT 296 648 Left 2 !.param lin 0
TEXT 840 2912 Left 2 ;transconductance\n~2mS (Iabc=100uA)
TEXT 672 2512 Left 2 ;target: 25mVpp
TEXT 432 2616 Left 2 ;gain: -1/200
TEXT 1488 2440 Left 2 ;manual offset elimination\nfor gain plots
TEXT 1136 2768 Left 2 ;transresistance\n-(1/2mS * (-200)) = -100kOhm
TEXT 448 2648 Left 2 ;adjustable
