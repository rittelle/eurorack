Version 4
SHEET 1 1392 1336
WIRE 752 -176 736 -176
WIRE 976 -144 976 -176
WIRE 560 -128 560 -160
WIRE 752 -128 752 -176
WIRE 976 -32 976 -64
WIRE 976 -32 944 -32
WIRE 944 -16 944 -32
WIRE 240 16 192 16
WIRE 368 16 320 16
WIRE 528 16 368 16
WIRE 976 16 976 -32
WIRE 368 32 368 16
WIRE 704 64 704 32
WIRE 752 64 752 -48
WIRE 528 96 528 16
WIRE 640 96 528 96
WIRE 368 128 368 112
WIRE 368 128 336 128
WIRE 560 128 560 -48
WIRE 640 128 560 128
WIRE 976 128 976 96
WIRE 368 144 368 128
WIRE 640 160 560 160
WIRE 896 208 896 192
WIRE 960 208 896 208
WIRE 1024 208 960 208
WIRE 1120 208 1088 208
WIRE 1168 208 1120 208
WIRE 704 224 704 192
WIRE 784 224 784 192
WIRE 800 224 784 224
WIRE 816 224 816 192
WIRE 816 224 800 224
WIRE 368 240 368 224
WIRE 560 240 560 160
WIRE 560 240 368 240
WIRE 960 240 960 208
WIRE 1120 240 1120 208
WIRE 800 288 800 224
WIRE 800 320 800 288
WIRE 960 352 960 320
WIRE 1120 368 1120 320
WIRE 800 432 800 400
WIRE 944 512 928 512
WIRE 1232 544 1200 544
WIRE 928 592 928 512
WIRE 1200 592 1200 544
WIRE 784 656 768 656
WIRE 784 704 784 656
WIRE 1200 704 1200 672
WIRE 928 768 928 672
WIRE 256 848 240 848
WIRE 304 848 256 848
WIRE 432 848 384 848
WIRE 592 848 432 848
WIRE 432 864 432 848
WIRE 736 896 736 864
WIRE 784 896 784 784
WIRE 592 928 592 848
WIRE 672 928 592 928
WIRE 432 960 432 944
WIRE 432 960 400 960
WIRE 432 976 432 960
WIRE 672 992 624 992
WIRE 928 1040 928 1024
WIRE 992 1040 928 1040
WIRE 1056 1040 992 1040
WIRE 1152 1040 1120 1040
WIRE 1200 1040 1152 1040
WIRE 736 1056 736 1024
WIRE 816 1056 816 1024
WIRE 832 1056 816 1056
WIRE 848 1056 848 1024
WIRE 848 1056 832 1056
WIRE 432 1072 432 1056
WIRE 624 1072 624 992
WIRE 624 1072 432 1072
WIRE 992 1072 992 1040
WIRE 1152 1072 1152 1040
WIRE 832 1120 832 1056
WIRE 832 1152 832 1120
WIRE 992 1184 992 1152
WIRE 1152 1200 1152 1152
WIRE 832 1264 832 1232
FLAG 976 -176 V+
FLAG 976 128 V-
FLAG 944 -16 0
FLAG 704 32 V+
FLAG 704 224 V-
FLAG 928 768 0
FLAG 800 432 0
FLAG 1168 208 out1
IOPIN 1168 208 Out
FLAG 960 352 V-
FLAG 800 288 out1_ota
FLAG 560 -160 V+
FLAG 336 128 0
FLAG 1200 704 0
FLAG 1120 368 0
FLAG 736 864 V+
FLAG 736 1056 V-
FLAG 832 1264 0
FLAG 256 848 in
FLAG 1200 1040 out2
IOPIN 1200 1040 Out
FLAG 992 1184 V-
FLAG 832 1120 out2_ota
FLAG 400 960 0
FLAG 1152 1200 0
FLAG 1232 544 gain_ctrl
IOPIN 1232 544 Out
FLAG 736 -176 gain_ctrl
IOPIN 736 -176 In
FLAG 768 656 gain_ctrl
IOPIN 768 656 In
FLAG 192 16 in
IOPIN 192 16 In
FLAG 240 848 in
IOPIN 240 848 In
FLAG 944 512 in
IOPIN 944 512 Out
SYMBOL voltage 976 -160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 44 Left 2
SYMATTR InstName V1
SYMATTR Value 12
SYMBOL voltage 976 0 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 12
SYMBOL AutoGenerated\\LM13700_NS 784 128 R0
SYMATTR InstName U1
SYMBOL voltage 928 576 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 124 Left 2
SYMATTR InstName V3
SYMATTR Value SINE(0 1 1k)
SYMBOL res 944 224 R0
SYMATTR InstName R1
SYMATTR Value 5k
SYMBOL res 784 304 R0
SYMATTR InstName R4
SYMATTR Value 30k
SYMBOL res 544 -144 R0
SYMATTR InstName R6
SYMATTR Value {Rdiode}
SYMBOL res 336 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 30k
SYMBOL res 352 16 R0
SYMATTR InstName R3
SYMATTR Value {trim1*1k}
SYMBOL res 352 128 R0
SYMATTR InstName R5
SYMATTR Value {(1-trim1)*1k}
SYMBOL voltage 1200 576 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value {Vgain}
SYMBOL res 736 -144 R0
SYMATTR InstName R7
SYMATTR Value 30k
SYMBOL cap 1088 192 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 1µ
SYMBOL res 1104 224 R0
SYMATTR InstName R8
SYMATTR Value 100k
SYMBOL AutoGenerated\\LM13700_NS 816 960 R0
SYMATTR InstName U2
SYMBOL res 976 1056 R0
SYMATTR InstName R9
SYMATTR Value 5k
SYMBOL res 816 1136 R0
SYMATTR InstName R10
SYMATTR Value 3k
SYMBOL res 400 832 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 30k
SYMBOL res 416 848 R0
SYMATTR InstName R13
SYMATTR Value {trim2*1k}
SYMBOL res 416 960 R0
SYMATTR InstName R14
SYMATTR Value {(1-trim2)*1k}
SYMBOL res 768 688 R0
SYMATTR InstName R15
SYMATTR Value 30k
SYMBOL cap 1120 1024 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 1µ
SYMBOL res 1136 1056 R0
SYMATTR InstName R16
SYMATTR Value 100k
TEXT 424 552 Left 2 ;.dc V3 -1 1 10m
TEXT 480 -216 Left 2 !.param Rdiode=13k
TEXT 424 576 Left 2 ;.temp 0 10 20 30
TEXT 344 272 Left 2 !.param trim1=0.67
TEXT 1112 752 Left 2 !.param Vgain=12
TEXT 422 600 Left 2 !.tran 5m
TEXT 656 488 Left 2 ;with linearization
TEXT 408 1104 Left 2 !.param trim2=0.8
TEXT 688 1320 Left 2 ;without linearization
